#!/bin/bash
# shellcheck disable=SC1090,SC2154

#
# Want to add a function that can be shared amongst all the .studiorcs? Add it
# to a file in the `dot-studio` directory. This file is for ci-studio-common's
# studio only.
#

function install_from_source() {
  pushd /src > /dev/null
    build .
    source results/last_build.env
    hab pkg install "results/$pkg_artifact"
    source "$(hab pkg path $pkg_ident)/bin/studio-common"
    OPTS="--binlink" install alasconnect/shellcheck
  popd > /dev/null
}

function lint() {
  pushd /src > /dev/null
    shellcheck -s bash bin/* lib/*
  popd > /dev/null
}

function syntax() {
  pushd /src > /dev/null
    bash -n bin/* lib/*
  popd > /dev/null
}

function ci_lint() {
  install_from_source > /dev/null
  lint && echo "Lint Passed"
}

function ci_syntax() {
  install_from_source > /dev/null
  syntax && echo "Syntax Passed"
}
