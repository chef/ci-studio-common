#!/bin/bash
# shellcheck disable=SC1090,SC2154

#
# Want to add a function that can be shared amongst all the .studiorcs? Add it
# to a file in the `dot-studio` directory. This file is for ci-studio-common's
# studio only.
#

function install_from_source() {
  cd /src || return
  build .
  # shellcheck disable=SC1091
  source results/last_build.env
  hab pkg install "results/$pkg_artifact"
  source "$(hab pkg path "$pkg_ident")/bin/studio-common"
  OPTS="--binlink" install alasconnect/shellcheck
}

function lint() {
  # shellcheck disable=2086
  shellcheck /src/bin/* /src/dot-studio/*
}

function syntax() {
  bash -n /src/bin/* src/dot-studio/*
}

function ci_lint() {
  install_from_source > /dev/null
  lint && echo "Lint Passed"
}

function ci_syntax() {
  install_from_source > /dev/null
  syntax && echo "Syntax Passed"
}
